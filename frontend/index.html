<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>RobloxModss</title>
<style>
  body {
    margin: 0;
    padding: 0;
    background-color: #2f2f2f;
    color: white;
    font-family: "Roboto", sans-serif;
    overflow: hidden;
    user-select: none;
    touch-action: none;
  }
  h1 {
    font-size: 28px;
    margin: 10px 0;
    text-align: center;
  }
  .info {
    font-size: 18px;
    color: #ccc;
    text-align: center;
    margin: 5px 0;
  }
  .drag-area {
    position: fixed;
    bottom: 0;
    width: 100%;
    height: 70px;
    background: #3a3a3a;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: #bbb;
    font-size: 16px;
    letter-spacing: 0.5px;
    z-index: 100;
  }
  .drag-area::before {
    content: "";
    position: absolute;
    top: 10px;
    width: 60px;
    height: 5px;
    border-radius: 10px;
    background: #666;
  }
  #modListContainer {
    position: fixed;
    bottom: -80%;
    left: 0;
    width: 100%;
    height: 80%;
    background: #1e1e1e;
    border-top-left-radius: 20px;
    border-top-right-radius: 20px;
    overflow-y: auto;
    transition: bottom 0.3s ease;
    padding: 15px;
    box-sizing: border-box;
  }
  .mod-card {
    background: #2f2f2f;
    border-radius: 10px;
    padding: 10px 15px;
    margin-bottom: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 16px;
    color: #fff;
  }
  .mod-card .status {
    padding: 2px 8px;
    border-radius: 5px;
    font-size: 14px;
    font-weight: bold;
  }
  .status.up {
    background-color: #28a745;
    color: white;
  }
  .status.outdated {
    background-color: #dc3545;
    color: white;
  }
</style>
</head>
<body>
<h1 id="status">Проверка Roblox...</h1>
<div class="info" id="version">Версия: —</div>
<div class="info" id="modType">Модификация: —</div>

<div id="modListContainer"></div>
<div class="drag-area">Протяните вверх для открытия списка модификаций</div>

<script>
const dragArea = document.querySelector('.drag-area');
const modListContainer = document.getElementById('modListContainer');
let startY = 0;
let currentBottom = 0;
let dragging = false;
const maxHeight = window.innerHeight * 0.8;

// Drag панель
dragArea.addEventListener('touchstart', e => {
  startY = e.touches[0].clientY;
  dragging = true;
  currentBottom = parseFloat(getComputedStyle(modListContainer).bottom) || -maxHeight;
  modListContainer.style.transition = 'none';
});
dragArea.addEventListener('touchmove', e => {
  if (!dragging) return;
  const touchY = e.touches[0].clientY;
  let diff = startY - touchY;
  let newBottom = Math.min(Math.max(currentBottom + diff, -maxHeight), 0);
  modListContainer.style.bottom = newBottom + 'px';
  e.preventDefault();
}, {passive: false});
dragArea.addEventListener('touchend', e => {
  if (!dragging) return;
  dragging = false;
  modListContainer.style.transition = 'bottom 0.3s ease';
  const bottomValue = parseFloat(modListContainer.style.bottom);
  if (bottomValue > -maxHeight / 2) {
    modListContainer.style.bottom = '0';
  } else {
    modListContainer.style.bottom = -maxHeight + 'px';
  }
});

// Функция обновления статуса Roblox
function updateInfo(found, version, modType) {
  document.getElementById('status').textContent = found ? "✅ Roblox найден" : "❌ Roblox не найден";
  document.getElementById('version').textContent = "Версия: " + (version || "—");
  document.getElementById('modType').textContent = "Модификация: " + (modType || "—");
}

// Загрузка модификаций из JSON
function loadMods() {
  fetch('https://roblox-modss.vercel.app/backend/data.json')
    .then(res => res.json())
    .then(data => {
      modListContainer.innerHTML = '';
      data.forEach(mod => {
        const card = document.createElement('div');
        card.className = 'mod-card';
        card.innerHTML = `
          <span>${mod.name} (v${mod.version})</span>
          <span class="status ${mod.upToDate ? 'up' : 'outdated'}">
            ${mod.upToDate ? 'Обновлено' : 'Устарело'}
          </span>
        `;
        modListContainer.appendChild(card);
      });
    })
    .catch(err => {
      console.error('Ошибка загрузки модификаций:', err);
    });
}

// Получение данных от AndroidBridge
if (window.AndroidBridge) {
  AndroidBridge.getUserModType?.(type => {
    updateInfo(true, AndroidBridge.getRobloxVersion?.() || '—', type);
    loadMods();
  });
}
</script>
</body>
</html>
